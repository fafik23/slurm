sudo: required
language: c
addons:
  mariadb: '10.1'
  apt:
    packages:
    - cmake
    - libmunge-dev 
    - liblua5.2-dev
    - munge
    - expect
    - libhwloc-dev
    - libnuma1
    - libnuma-dev
    - libpam-dev
    - libhwloc-dev
    - gdb
    - valgrind
    - libfreeipmi-dev
    - man2html
compiler:
  - clang
  - gcc
env:
  - TEST_SET="1.*" SLURMDB_VER="master" - SLURMD_VER="slurm-16.05" - SLURMCTL_VER="slurm-16.05" - SLURMCLI_VER="slurm-16.05"
  - TEST_SET="2.*,3.*,4.*,5.*,6.*,7.*,8.*" SLURMDB_VER="master" - SLURMD_VER="slurm-16.05" - SLURMCTL_VER="slurm-16.05" - SLURMCLI_VER="slurm-16.05"
  - TEST_SET="9.*,12.*,14.*,15.*,16.*" SLURMDB_VER="master" - SLURMD_VER="slurm-16.05" - SLURMCTL_VER="slurm-16.05" - SLURMCLI_VER="slurm-16.05"
  - TEST_SET="17.*,18.*,19.*,20.*,21.*,22.*,23.*,24.*,25.*" SLURMDB_VER="master" - SLURMD_VER="slurm-16.05" - SLURMCTL_VER="slurm-16.05" - SLURMCLI_VER="slurm-16.05"
  - TEST_SET="27.*,28.*,30.*,31.*,32.*,33.*,34.*,36.*" SLURMDB_VER="master" - SLURMD_VER="slurm-16.05" - SLURMCTL_VER="slurm-16.05" - SLURMCLI_VER="slurm-16.05"

cache: ccache
before_script:
  - export PATH=/usr/lib/ccache:$PATH
  - sudo mount -t tmpfs -o size=1024m tmpfs /tmp
script:
  - ./configure --enable-multiple-slurmd --prefix=/tmp/slurm/ > /dev/null
  - make -j > /dev/null
  - make -j install > /dev/null
  - testsuite/build-travis.sh
  - sudo testsuite/test-reg.sh
